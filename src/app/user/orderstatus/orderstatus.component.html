<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">

<main>
    <app-navbar></app-navbar>

    <div class="container-fluid">
        <div class="row">
            <div class="col-md-10 col-11 mx-auto">
                <div class="row mt-5 gx-3">
                    <!----left side div-->
                    <div class="col-md-12 col-lg-2 col-sm-5 mx-auto left_div mb-lg-0 mb-5">
                        <app-sidemenu></app-sidemenu>
                    </div>

                    <!-- right -->
                    <div class="col-md-12 col-lg-10 col-sm-7 mx-auto mt-lg-0 mt-md-5">
                        <div class="title">
                            <h1>My Orders</h1>
                        </div>
                        <div class="card my-lg-4 shadow-lg ">
                          <div *ngFor="let trans of transactions">
                            <div class="row justify-content-between" *ngIf="user.user_id == trans.user_id && trans.deliver_st == 0">
                            <div class="col my-auto">
                            <!--Card per item-->
                            <div class="container-fluid my-5 d-sm-flex justify-content-center">
                                <div class="card px-2 shadow sm">
                                    <div class="card-header bg-white">
                                        <div class="row justify-content-between">
                                            <div class="col">
                                                <p class="text-muted"> Order ID <span class="font-weight-bold text-dark">{{ trans.transaction_no}}</span></p>
                                                <p class="text-muted"> Place On <span class="font-weight-bold text-dark">{{ trans.checkout_time | date:'longDate'}} </span> </p>
                                            </div>
                                            <div class="flex-col my-auto">
                                                <!--<h6 class="ml-auto mr-3"> <a href="#">View Details</a> </h6>-->
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-body">
                                      <!--  -->
                                        <!-- <div class="media flex-column flex-sm-row" >
                                            <div class="media-body ">
                                                <h5 class="bold">SMART JACKET LS</h5>
                                                <p class="text-muted"> Qt: 1</p>
                                                <h4 class="mt-3 mb-4 bold"> <span class="mt-5">&#8369;</span> 40,385.60 <span class="small text-muted"> via Master Card </span></h4>

                                            </div><img class="align-self-center img-fluid" src="https://dainese-cdn.thron.com/delivery/public/image/dainese/025ded97-f60b-4856-956d-31c531b214c5/ramfdh/std/615x615/smart-jacket-ls-black.jpg" width="180 " height="180">
                                        </div> -->


                                        <div class="media flex-column flex-sm-row" *ngFor="let order of orders">
                                          <div *ngIf="order.transaction_no == trans.transaction_no">
                                          <div class="media-body">
                                              <h5 class="bold">{{order.product_name}} </h5>
                                              <p class="text-muted"> Qt:{{order.qty}}</p>
                                              <h4 class="mt-3 mb-4 bold"> <span class="mt-5">&#8369;</span> {{order.qty * order.price}} <span class="small text-muted"> via Google Pay </span></h4>

                                          </div><img class="align-self-center img-fluid" src={{order.product_img}} width="180 " height="180">
                                        </div>



                                      </div>
                                      <p class="text-muted">Tracking Status on: <span class="Today">11:30pm, Today</span></p> <button type="button" class="btn btn-outline-primary d-flex" (click)="open(content)">GearUp Warehouse, Olongapo City</button>
                                        <!--  -->

                                         <!-- Modal Rating -->
                                        <!--Modal for tracking-->
                                        <ng-template #content let-c="close" let-d="dismiss">
                                          <div class="modal-header">
                                          <!-- <h4 class="modal-title" id="modal-basic-title">Order Status</h4> -->
                                          <h4 class="modal-title" id="modal-basic-title">Rate our Gears</h4>
                                          <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                                              <span aria-hidden="true">&times;</span>
                                          </button>
                                          </div>
                                          <div class="modal-body">

                                            <div *ngFor="let order of orders">
                                              <div *ngIf="order.transaction_no == trans.transaction_no">
                                                <div class="media-body">
                                                    <h5 class="bold">{{order.product_name}} </h5>
                                                    <p class="text-muted"> Qt:{{order.qty}}</p>
                                                    <h4 class="mt-3 mb-4 bold"> <span class="mt-5">&#8369;</span> {{order.qty * order.price}} <span class="small text-muted"> via Google Pay </span></h4>

                                                </div><img class="align-self-center img-fluid" src={{order.product_img}} width="180 " height="180">
                                                <ng-template #t let-fill="fill">
                                                  <span class="star" [class.full]="fill === 100">
                                                    <span class="half" [style.width.%]="fill">&#9733;</span>&#9733;
                                                  </span>
                                                </ng-template>

                                                <ngb-rating [(rate)]="order.rating" (click)="oldrate(order.rating)" (rateChange)="rate(order)"  [starTemplate]="t"  [max]="5"></ngb-rating>

                                                <hr>
                                                </div>
                                              </div>



                                          <!--ORDER STATUS-->

                                          <!-- <app-orderstat></app-orderstat> -->

                                          <!--ORDER STATUS ENDS HERE-->
                                          </div>
                                          <div class="modal-footer">
                                          <button  type="button" class="btn mb-3 btn-outline-dark " (click)="endTransact(trans.transaction_no)" (click)="d('Cross click')">Finish Transaction</button>
                                          </div>
                                      </ng-template>
                                      <!--Modal for tracking-->
                                      <!-- Modal Rating -->

                                    </div>
                                    <div class="row px-3">
                                        <div class="col">
                                            <ul id="progressbar">
                                                <li class="step0 active " id="step1">PLACED</li>
                                                <li class="step0 active text-center" id="step2">SHIPPED</li>
                                                <li class="step0 text-muted text-right" id="step3">DELIVERED</li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="card-footer bg-white px-sm-3 pt-sm-4 px-0">
                                        <div class="row text-center ">
                                            <div class="col my-auto ">
                                                <h5 (click)="open(content)">Received</h5>
                                            </div>
                                            <div class="col my-auto ">
                                                <h5 class="text-danger">Cancel</h5>
                                            </div>
                                            <div class="col my-auto mx-0 px-0 "><img class="img-fluid cursor-pointer" src="https://img.icons8.com/ios/50/000000/menu-2.png" width="30" height="30"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--end of card per item-->
                            </div><!--end of col 1-->

                        <div class="col mr-4 addcol">
                            <!--address-->
                            <div class="card mr-4 shadow ordersumcard">
                                <div class="right border px-md-4 py-md-4">
                                    <h5 class="order_summary mb-5">Location</h5>
                                    <div class="location_div d-flex justify-content-between">
                                        <p><i class="fas fa-map-marker-alt"></i> {{user.house_no}} {{user.street}} {{user.barangay}} {{user.cityMunicipality}} {{user.province}}</p>
                                    </div>

                            </div>
                            <!--address end-->
                            </div>

                            <!--Order summary-->
                            <div class="card mr-4 shadow ordersumcard">
                                <div class="right border px-md-4 py-md-4">
                                    <div class="header">Order Summary</div>
                                    <!-- <p>{{orders.length}} item(s)</p> -->
                                    <hr>
                                    <div class="row lower">
                                        <div class="col text-left">Subtotal</div>
                                        <div class="col text-right"><span>&#8369;</span>{{trans.payment - 100}}.00</div>
                                    </div>
                                    <div class="row lower">
                                        <div class="col text-left">Delivery</div>
                                        <div class="col text-right"><span>&#8369;</span>100</div>
                                    </div>
                                    <div class="row lower">
                                        <div class="col text-left"><b>Total to pay</b></div>
                                        <div class="col text-right text-primary"><span>&#8369;</span><b>{{trans.payment}}.00</b></div>
                                    </div>
                            </div>
                            <!--order summary end-->
                            </div>

                            </div><!--end of row-->
                       <!--End of card-->
                      </div>
                    </div>
                    </div><!--end of col2-->

                </div>

                </div>
            </div><!--end of col 1-->
        </div>
    </div>

    <app-footer></app-footer>
    </main>
